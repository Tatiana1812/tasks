Общая схема работы редактора
============================

Внутренняя логика работы редактора сосредоточена в пакете `editor`.

Основными единицами представления в редакторе являются **билдеры** (интерфейс [i_BodyBuilder](body_builder.md)), **тела** (интерфейс `i_Body`) и **якоря** (интерфейс `i_Anchor`).

**Билдер** является "инструкцией по сборке" некоторого тела (см. [Паттерн Builder](https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D1%80%D0%BE%D0%B8%D1%82%D0%B5%D0%BB%D1%8C_%28%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%29))

**Тело** - геометрический объект в обычном понимании пользователя (точка, прямая, плоскость, сфера и т. п.); в пользовательском интерфейсе (UI) отображаются именно тела (в списке объектов и при рисовании сцены). Каждый билдер строит *ровно одно* тело.

**Якоря** являются вспомогательными объектами и представляют геометрические объекты, которые могут быть общими для нескольких тел. Все точки, рёбра, грани и круги на сцене хранятся в виде якорей. Это нужно по двум причинам: объект, общий для нескольких тел должен быть нарисован на сцене *ровно один раз*; при построении тела по общему для нескольких тел объекту (например, общей грани для двух многогранников) пользователь не должен явно указывать, по чьей именно грани он хочет построить тело (общая грань должна иметь только одно представление). Также якоря используются в случаях, когда помимо некоторого тела логично создать вспомогательные точки, привязанные к этому телу: так, при построении сферы по четырём точкам в качестве якоря создаётся точка - центр сферы. Для того чтобы с якорями можно было работать через UI, каждый якорь "оборачивается" в интерфейс `i_Body`.

------------------------------------------------------------------------

Класс `editor.Editor` хранит геометрические данные сцены.

`Editor` инкапсулирует три объекта: `BodyBuilderContainer`, `AnchorContainer` и `BodyContainer`.

Класс `BodyBuilderContainer`
----------------------------

------------------------------------------------------------------------

`BodyBuilderContainer` хранит список билдеров. По этому списку можно восстановить все объекты на сцене. При перестроении пользователем сцены (перемещении точки, добавлении или удалении тела, изменении параметров построения тела) происходит следующее: списки тел и якорей очищаются, все билдеры из `BodyBuilderContainer` вызываются по порядку и создают тела и якоря заново. Пример: пользователь перемещает точку - в соответствующем этой точке билдере изменяется параметр (координаты точки) - `AnchorContainer` и `BodyContainer` очищаются - все билдеры заново вызываются по цепочке.

Класс `BodyContainer`
---------------------

------------------------------------------------------------------------

`BodyContainer` хранит список тел. Каждое тело является результатом работы метода `create()` соответствующего билдера. Также тело может не иметь билдера в том случае, когда оно является оболочкой для некоторого якоря. Пример: пользователь строит тетраэдр по четырём точкам - в качестве якорей создаются все рёбра и грани тетраэдра (если их до этого не было на сцене) - для каждого нового якоря создаётся тело-оболочка (чтобы пользователь мог работать с рёбрами и гранями как с самостоятельными объектами).

Класс `AnchorContainer`
-----------------------

------------------------------------------------------------------------

`AnchorContainer` хранит список якорей. Якоря (точки, рёбра, грани и круги) создаются в процессе построения тел.
